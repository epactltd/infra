Service,Role/Resource,Action(s),Purpose,Attached Policy / Notes
AWS KMS,modules/security KMS key,CreateGrant;DescribeKey;Encrypt;Decrypt,Encrypt security logs and SNS topics,"Managed via security module; alias `${project_name}-security`; 30-day deletion window"
AWS KMS,modules/vpc flow logs KMS key,Encrypt;Decrypt,Enable VPC flow log bucket SSE-KMS,"Key created per VPC module; 30-day deletion window"
AWS KMS,modules/database RDS KMS key,Encrypt;Decrypt,Protect RDS storage and Performance Insights,"Key alias `${project_name}-rds`; 30-day deletion window; enables key rotation"
AWS KMS,Terraform state KMS key,Encrypt;Decrypt,Encrypt Terraform remote state in S3,"Pre-requisite: alias `terraform-state-key` must exist before terraform init; 30-day deletion window recommended"
AWS Backup,Backup service role,backup:StartBackupJob;backup:StartRestoreJob;backup:TagResource,Execute automated backups (daily 05:00 + weekly 06:00),"AWSBackupServiceRolePolicyForBackup attached; vault encrypted with security KMS key"
AWS Backup,Backup vault,N/A,Store RDS and EC2 backups,"Daily: 30d retention + 90d copy; Weekly: 365d with cold storage after 30d"
AWS Backup,Tenant Lambda,backup:TagResource,Tag S3 buckets for backup plan selection,"Resource ARN `arn:aws:backup:region:acct:backup-vault:${backup_vault_name}`"
AWS Lambda,Tenant provisioner role,sts:AssumeRole,Allow Lambda execution,"Trusts lambda.amazonaws.com; least-privilege inline policy"
AWS Lambda,Tenant provisioner role,s3:CreateBucket;s3:PutBucketVersioning;s3:PutBucketPublicAccessBlock;s3:PutBucketTagging;s3:PutBucketPolicy;s3:PutBucketEncryption;s3:GetBucketLocation,Provision tenant buckets with security hardening,"Resource scoped to `arn:aws:s3:::${project_name}-tenant-*`"
AWS Lambda,Tenant provisioner role,kms:CreateGrant;kms:DescribeKey,Encrypt tenant buckets,"Scoped to backup KMS key ARN"
AWS Lambda,Tenant provisioner role,cloudwatch:PutMetricData,Emit provisioning metrics,"Namespace `${project_name}/TenantProvisioning`; conditional on namespace"
AWS Lambda,Tenant provisioner role,logs:CreateLogGroup;logs:CreateLogStream;logs:PutLogEvents,Ship Lambda logs with 90-day retention,"Log group `/aws/lambda/${project_name}-${environment}-tenant-provisioner` with KMS encryption"
Amazon EC2,Application instance role,s3:GetObject;s3:ListBucket,Fetch artifacts from deploy bucket,"Custom IAM policy `${project_name}-${environment}-ec2-policy`"
Amazon EC2,Application instance role,logs:CreateLogGroup;logs:CreateLogStream;logs:PutLogEvents,Write application logs to CloudWatch,"Scoped to `arn:aws:logs:region:*:log-group:/${project_name}/*`; 90-day retention"
Amazon EC2,Application instance role,ssm:GetParameter;ssm:GetParameters,Retrieve configuration parameters,"Parameter path `/${project_name}/*`; secure string support"
Amazon EC2,Launch template,N/A,EC2 instance configuration,"EBS encryption enabled; IMDSv2 enforced (http_tokens=required); gp3 30GB volumes"
Amazon EventBridge,EventBridge invocation role,sts:AssumeRole,Allow EventBridge to invoke Lambda,"Trusts events.amazonaws.com"
Amazon EventBridge,EventBridge invocation role,lambda:InvokeFunction,Invoke tenant provisioner Lambda on tenant.created events,"✅ IMPROVED: Inline least-privilege policy scoped to specific Lambda ARN (replaced AmazonEventBridgeFullAccess)"
Amazon SNS,SNS topic,kms:Encrypt;kms:Decrypt,SNS topic encryption for alerts,"Uses security KMS key ARN; email subscription for ops team"
AWS CloudWatch,Autoscaling policy - Scale Up,autoscaling:SetDesiredCapacity,Scale ASG up when CPU >80%,"Step scaling policy; cooldown managed by monitoring module"
AWS CloudWatch,Autoscaling policy - Scale Down,autoscaling:SetDesiredCapacity,Scale ASG down when CPU <30% (3 eval periods),"✅ NEW: Bidirectional scaling for cost optimization"
AWS CloudWatch,Monitoring alarms,sns:Publish,Notify on alarms (ALB 5xx / ASG CPU / RDS CPU / Lambda errors),"Topic `${project_name}-${environment}-alerts`; KMS encrypted"
AWS CloudWatch,Log groups,N/A,Application and Lambda logs,"90-day retention; KMS encryption; `/aws/${project_name}/${environment}/application`"
AWS WAF,WAF Web ACL,wafv2:AssociateWebACL,Protect ALB from common attacks,"✅ IMPROVED: WAF now directly associated with ALB; managed rules + rate limiting (2000/IP)"
AWS Config,AWS Config role,sts:AssumeRole,Allow AWS Config recording,"Policy `service-role/AWSConfigRole` attached; records all resources"
AWS Config,Config delivery channel,s3:PutObject,Write config snapshots to S3,"Bucket with KMS encryption; TLS-enforcing bucket policy; lifecycle: 30d→IA→90d→Glacier→365d expire"
AWS CloudTrail,CloudTrail service,s3:PutObject,Write audit logs,"KMS encrypted; TLS-enforcing bucket policy; log file validation enabled; single-region"
AWS GuardDuty,GuardDuty detector,guardduty:Get*;guardduty:List*,Threat detection with S3 and EBS malware scanning,"Findings sent to Security Hub; datasources: S3 logs + EBS malware protection"
AWS Security Hub,Security Hub,securityhub:BatchImportFindings,Aggregate security findings,"CIS AWS Foundations Benchmark v1.4.0 + PCI DSS v3.2.1 standards enabled"
Amazon S3,VPC Flow Logs bucket,s3:PutObject,Store VPC flow logs,"✅ IMPROVED: KMS encryption + TLS-only policy + lifecycle (30d→IA→90d→Glacier→365d expire)"
Amazon S3,ALB Access Logs bucket,s3:PutObject,Store ALB access logs,"✅ IMPROVED: Upgraded from SSE-S3 to KMS encryption + TLS-only policy + lifecycle (30d→IA→90d→Glacier→365d expire)"
Amazon S3,Tenant buckets,s3:*,Per-tenant data storage,"Versioned; KMS encrypted; public access blocked; TLS-only policy; tagged for backup"
Amazon RDS,RDS instance,rds:Describe*,MySQL 8.0.33 database,"Multi-AZ; encrypted with RDS KMS key; 7-day native backups (03:00-04:00); slow query logging enabled"
Amazon RDS,RDS security group,N/A,Database access control,"✅ NEW: Dedicated security group; ingress only from application security group on port 3306"
AWS IAM,Terraform execution role,sts:AssumeRole / Broad AWS service permissions,Provision and manage all infrastructure,"Requires permissions for VPC/EC2/RDS/KMS/S3/Lambda/CloudWatch/WAF/GuardDuty/SecurityHub/Config/Backup/EventBridge"
AWS IAM,Terraform backend access,s3:GetObject;s3:PutObject;dynamodb:GetItem;dynamodb:PutItem;kms:Decrypt;kms:Encrypt,Manage remote state with locking,"✅ IMPROVED: State bucket now KMS encrypted with `alias/terraform-state-key`; DynamoDB table for state locking"

